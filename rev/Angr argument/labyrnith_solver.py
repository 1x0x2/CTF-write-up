import angr

aaa = [367604, 25179, 4729, 4823, 4893, 4963, 5055, 5147, 5286, 5380, 5452, 5568, 5660, 5798, 5890, 5960, 6032, 6168, 6307, 6399, 6469, 6605, 6677, 6815, 6931, 7001, 7071, 7210, 7280, 7352, 7468, 7606, 7722, 7794, 7866, 7982, 8054, 8193, 8263, 8357, 8427, 8499, 8593, 8709, 8845, 8937, 9029, 9145, 9215, 9331, 9447, 9586, 9678, 9748, 9842, 9981, 10119, 10257, 10395, 10467, 10537, 10631, 10701, 10840, 10979, 11093, 11187, 11325, 11395, 11489, 11561, 11700, 11770, 11864, 12002, 12118, 12232, 12304, 12420, 12558, 12630, 12766, 12838, 12932, 13071, 13163, 13235, 13329, 13445, 13583, 13677, 13816, 13954, 14093, 14185, 14323, 14393, 14531, 14623, 14759, 14851, 14945, 15037, 15109, 15225, 15297, 15389, 15528, 15622, 15738, 15808, 15902, 15996, 16090, 16162, 16278, 16370, 16484, 16578, 16670, 16786, 16900, 16994, 17066, 17138, 17276, 17392, 17462, 17600, 17716, 17832, 17970, 18109, 18181, 18251, 18321, 18437, 18576, 18714, 18784, 18876, 19014, 19153, 19247, 19363, 19479, 19549, 19687, 19825, 19895, 20011, 20127, 20221, 20293, 20432, 20548, 20662, 20734, 20872, 21010, 21148, 21262, 21334, 21450, 21520, 21658, 21752, 21868, 22007, 22123, 22261, 22399, 22493, 22587, 22726, 22818, 22910, 23026, 23096, 23232, 23302, 23394, 23486, 23580, 23652, 23788, 23902, 24018, 24134, 24206, 24278, 24417, 24556, 24694, 24808, 24946, 25085, 25232, 367589]

i = 3

proj = angr.Project("chall")
image_base = 0x400000
#addr_main = 0x59BF8 + image_base
#addr_target = 0x59BF8
#addr_target = 0x0808aeb0
#addr_target = 0x59C56 + image_base
finalle = ""
for i in range(len(aaa) - 1):
    addr_main = aaa[i] + image_base
    addr_target = aaa[i+1] + image_base
    state = proj.factory.entry_state(addr=addr_main)
    sm = proj.factory.simulation_manager(state)

    sm.explore(find=addr_target)
    while len(sm.found) == 0:
        sm.step()

    if (len(sm.found) > 0):
        print("found: %d" % i)
        found_input = sm.found[0].posix.dumps(0) # this is the stdin
        finalle = finalle + found_input.decode("utf-8") 
        #print(found_input)

print(finalle)